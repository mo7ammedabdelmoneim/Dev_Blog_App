@model PostIndexViewModel
@using System.Text.RegularExpressions

<style>
     .card:hover .card-title {
        color: #4f46e5;
    }
</style>

@if(Model.CurrentPage == 1)
{
    <section class="max-w-5xl mx-auto px-4 py-12">
        <div class="mb-12">
            <h2 class="text-4xl font-extrabold text-gray-900 flex items-center gap-3">
                <svg class="w-10 h-10 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z" />
                </svg>
                Featured Articles
            </h2>
            <p class="text-gray-600 mt-2">Handpicked posts you shouldn't miss</p>
        </div>

        @foreach (var post in Model?.FeaturedPosts)
        {

            <partial name="_PostCard" model="post" />

        }
    </section>
}





<section class="max-w-5xl mx-auto px-4 py-12">
    <div class="mb-10">
        <h2 class="text-4xl font-extrabold text-gray-900 flex items-center gap-3  ">
            <svg class="w-10 h-10 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
            </svg>
            Latest Articles
        </h2>
        <p class="text-gray-600 my-2">Fresh content from our community</p>
        
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 ">
        @foreach (var post in Model?.LatestPosts)
        {

                <div class="relative bg-white shadow rounded-2xl mb-8 transition-transform duration-300 hover:-translate-y-2 hover:shadow-xl card">
                <!-- Image -->
                <div class="relative">
                    <img src="@post?.CoverUrl" alt="@post?.Title" class="w-full h-48 object-cover rounded-t-2xl">
                    <div class="absolute top-4 left-4 flex flex-wrap gap-2">
                        @if (post?.Tags != null && post.Tags.Any())
                        {
                            foreach (var tag in post.Tags)
                            {
                                <a asp-controller="Post" asp-action="ByTag" asp-route-tag="@tag.Name"
                                   class=" inline-flex items-center px-3 py-1 rounded-full bg-gray-100 text-black text-xs font-semibold hover:bg-indigo-100 hover:text-indigo-600 transition-colors duration-200">
                                    @tag.Name
                                </a>
                            }
                        }
                    </div>
                </div>

                <!-- Content -->
                <div class="p-6">
                    <!-- Title -->
                    <h3 class="text-lg font-bold mb-3">
                        <a  asp-action="Details" asp-route-slug="@post?.Slug"
                           class=" card-title transition-colors duration-200 group-hover:text-indigo-600">
                            @post?.Title
                        </a>
                    </h3>

                    <!-- Snippet -->
                    <p class="text-gray-600 leading-relaxed mb-4 text-sm">
                        @{
                            var plainText = Regex.Replace(post?.Content ?? "", "<.*?>", string.Empty);
                            var snippet = plainText.Length > 120 ? plainText[..120] + "..." : plainText;
                        }
                        @snippet
                    </p>


                    <!-- Meta -->
                    <div class="flex items-center justify-between text-xs text-gray-500">
                        <div class="flex items-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M8 7V3m8 4V3M3 11h18M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                            </svg>
                            <span>@post?.CreationDate.ToString("MMM d, yyyy")</span>
                        </div>

                        <div class="flex items-center gap-1 text-gray-600">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-indigo-600"
                                 fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                      d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
                            </svg>
                            <span>@post?.Reacts</span>
                        </div>
                    </div>

                    <!-- Author + Read more -->
                    <div class="mt-4 flex items-center justify-between">
                        <div class="flex items-center gap-2 text-xs text-gray-700">
                            <svg xmlns="http://www.w3.org/2000/svg"
                                 class="w-4 h-4 text-gray-500"
                                 fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 12c2.7 0 4.9-2.2 4.9-4.9S14.7 2.2 12 2.2 7.1 4.4 7.1 7.1 9.3 12 12 12zm0 2c-3.3 0-9.8 1.7-9.8 5v2.7h19.6V19c0-3.3-6.5-5-9.8-5z" />
                            </svg>
                            <span>@post?.AuthorName</span>
                        </div>
                        <a asp-action="Details" asp-route-slug="@post?.Slug"
                           class="text-indigo-600 hover:underline text-xs font-medium flex items-center gap-1">
                            Read more →
                        </a>
                    </div>
                </div>
            </div>
        }
    </div>

    <!-- Pagination -->
    <div class="flex justify-center mt-8 space-x-2">
        @{
            int startPage = Math.Max(1, Model.CurrentPage - 2);
            int endPage = Math.Min(Model.TotalPages, Model.CurrentPage + 2);
        }

        <!-- Previous button -->
        @if (Model.CurrentPage > 1)
        {
            <a asp-action="Index" asp-route-pageNumber="@(Model.CurrentPage - 1)"
               class="px-3 py-1 rounded-lg border bg-white text-gray-700 hover:bg-indigo-100">
                Prev
            </a>
        }

        <!-- First page -->
        @if (startPage > 1)
        {
            <a asp-action="Index" asp-route-pageNumber="1"
               class="px-3 py-1 rounded-lg border bg-white text-gray-700 hover:bg-indigo-100">1</a>
            @if (startPage > 2)
            {
                <span class="px-3 py-1">...</span>
            }
        }

        <!-- Page numbers -->
        @for (int i = startPage; i <= endPage; i++)
        {
            <a asp-action="Index" asp-route-pageNumber="@i"
               class="px-3 py-1 rounded-lg border transition-colors duration-200
                  @(i == Model.CurrentPage ? "bg-indigo-600 text-white border-indigo-600" : "bg-white text-gray-700 border-gray-300 hover:bg-indigo-100")">
                @i
            </a>
        }

        <!-- Last page -->
        @if (endPage < Model.TotalPages)
        {
            @if (endPage < Model.TotalPages - 1)
            {
                <span class="px-3 py-1">...</span>
            }
            <a asp-action="Index" asp-route-pageNumber="@Model.TotalPages"
               class="px-3 py-1 rounded-lg border bg-white text-gray-700 hover:bg-indigo-100">@Model.TotalPages</a>
        }

        <!-- Next button -->
        @if (Model.CurrentPage < Model.TotalPages)
        {
            <a asp-action="Index" asp-route-pageNumber="@(Model.CurrentPage + 1)"
               class="px-3 py-1 rounded-lg border bg-white text-gray-700 hover:bg-indigo-100">
                Next
            </a>
        }
    </div>

</section>

