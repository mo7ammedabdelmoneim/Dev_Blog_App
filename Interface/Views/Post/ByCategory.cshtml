@model PostByCatViewModel

<section class="max-w-6xl mx-auto px-4 py-12">
    <div class="flex items-center justify-between mb-8">
        <h2 class="text-2xl font-bold">
            <span class="text-indigo-600">@Model.CategoryName </span> Posts
        </h2>
        <a asp-controller="Post" asp-action="Index"
           class="text-sm text-indigo-500 hover:underline">
            ← Back to all posts
        </a>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        @if (Model.Posts != null && Model.Posts.Any())
        {
            foreach (var post in Model.Posts)
            {
                <partial name="_PostCard" model="post" />
            }
        }
        else
        {
            <div class="col-span-full text-center py-12">
                <p class="text-gray-500 text-lg">No posts found for this Category.</p>
            </div>
        }
    </div>

    <!-- Pagination -->
    <div class="flex justify-center mt-8 space-x-2">
        @{
            int startPage = Math.Max(1, Model.CurrentPage - 2);
            int endPage = Math.Min(Model.TotalPages, Model.CurrentPage + 2);
        }

        <!-- Previous button -->
        @if (Model.CurrentPage > 1)
        {
            <a asp-action="ByTag" asp-route-pageNumber="@(Model.CurrentPage - 1) " asp-route-category="@Model.CategoryName"
               class="px-3 py-1 rounded-lg border bg-white text-gray-700 hover:bg-indigo-100">
                Prev
            </a>
        }

        <!-- First page -->
        @if (startPage > 1)
        {
            <a asp-action="ByTag" asp-route-pageNumber="1" asp-route-category="@Model.CategoryName"
               class="px-3 py-1 rounded-lg border bg-white text-gray-700 hover:bg-indigo-100">1</a>
            @if (startPage > 2)
            {
                <span class="px-3 py-1">...</span>
            }
        }

        <!-- Page numbers -->
        @for (int i = startPage; i <= endPage; i++)
        {
            <a asp-action="ByTag" asp-route-pageNumber="@i" asp-route-category="@Model.CategoryName"
               class="px-3 py-1 rounded-lg border transition-colors duration-200
                  @(i == Model.CurrentPage ? "bg-indigo-600 text-white border-indigo-600" : "bg-white text-gray-700 border-gray-300 hover:bg-indigo-100")">
                @i
            </a>
        }

        <!-- Last page -->
        @if (endPage < Model.TotalPages)
        {
            @if (endPage < Model.TotalPages - 1)
            {
                <span class="px-3 py-1">...</span>
            }
            <a asp-action="ByTag" asp-route-pageNumber="@Model.TotalPages" asp-route-category="@Model.CategoryName"
               class="px-3 py-1 rounded-lg border bg-white text-gray-700 hover:bg-indigo-100">@Model.TotalPages</a>
        }

        <!-- Next button -->
        @if (Model.CurrentPage < Model.TotalPages)
        {
            <a asp-action="ByTag" asp-route-pageNumber="@(Model.CurrentPage + 1)" asp-route-category="@Model.CategoryName"
               class="px-3 py-1 rounded-lg border bg-white text-gray-700 hover:bg-indigo-100">
                Next
            </a>
        }
    </div>

</section>
